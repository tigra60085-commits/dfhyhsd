"""Dose-calculator: dosing reference for psychotropic drugs.

Implements the dose-calc skill:
  ‚Ä¢ User enters drug name
  ‚Ä¢ Bot returns structured dosing information:
    starting dose, titration schedule, target range, max dose,
    special populations, forms available
"""

from telegram import Update
from telegram.ext import ContextTypes

from states import DOSE_CALC_DRUG, DOSE_CALC_RESULT, MAIN_MENU
from keyboards.menus import dose_calc_result_keyboard, main_menu_keyboard, back_keyboard
from data.drugs import get_drug_by_name, search_drugs


# ‚îÄ‚îÄ‚îÄ Static dosing tables ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

_DOSE_TABLE: dict[str, dict] = {
    "–§–ª—É–æ–∫—Å–µ—Ç–∏–Ω": {
        "start": "10‚Äì20 –º–≥/—Å—É—Ç",
        "target": "20‚Äì40 –º–≥/—Å—É—Ç",
        "max": "80 –º–≥/—Å—É—Ç (–¥–æ 120 –º–≥ –ø—Ä–∏ –±—É–ª–∏–º–∏–∏)",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∫–∞–∂–¥—ã–µ 2‚Äì4 –Ω–µ–¥ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏; –º–µ–¥–ª–µ–Ω–Ω–∞—è —Ç–∏—Ç—Ä–∞—Ü–∏—è —É —Ç—Ä–µ–≤–æ–∂–Ω—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç (—É—Ç—Ä–æ–º, —Ç.–∫. –∞–∫—Ç–∏–≤–∏—Ä—É—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 10/20/40 –º–≥; –∫–∞–ø—Å—É–ª—ã 20 –º–≥; —Ä–∞—Å—Ç–≤–æ—Ä 20 –º–≥/5 –º–ª",
        "elderly": "–ù–∞—á–∏–Ω–∞—Ç—å —Å 10 –º–≥/—Å—É—Ç; —Ü–µ–ª–µ–≤–∞—è 20 –º–≥/—Å—É—Ç",
        "renal": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏ –ª—ë–≥–∫–æ–º/—É–º–µ—Ä–µ–Ω–Ω–æ–º —Å–Ω–∏–∂–µ–Ω–∏–∏ –°–ö–§",
        "hepatic": "‚Üì –¥–æ–∑—É –∏–ª–∏ —É–¥–ª–∏–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª; –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥",
        "notes": "–î–ª–∏–Ω–Ω—ã–π T¬Ω (~1‚Äì4 –¥–Ω—è) + –∞–∫—Ç–∏–≤–Ω—ã–π –º–µ—Ç–∞–±–æ–ª–∏—Ç –Ω–æ—Ä—Ñ–ª—É–æ–∫—Å–µ—Ç–∏–Ω (7‚Äì15 –¥–Ω–µ–π) ‚Üí 5 –Ω–µ–¥ –æ—Ç–º—ã–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ MAOI",
    },
    "–°–µ—Ä—Ç—Ä–∞–ª–∏–Ω": {
        "start": "25‚Äì50 –º–≥/—Å—É—Ç",
        "target": "50‚Äì150 –º–≥/—Å—É—Ç",
        "max": "200 –º–≥/—Å—É—Ç",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –Ω–∞ 25‚Äì50 –º–≥ –∫–∞–∂–¥—ã–µ 1‚Äì2 –Ω–µ–¥",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç (—É—Ç—Ä–æ–º –∏–ª–∏ –≤–µ—á–µ—Ä–æ–º, —Å –µ–¥–æ–π ‚Äî ‚Üì –ñ–ö–¢-—ç—Ñ—Ñ–µ–∫—Ç—ã)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 50/100 –º–≥; —Ä–∞—Å—Ç–≤–æ—Ä 20 –º–≥/–º–ª",
        "elderly": "–ù–∞—á–∏–Ω–∞—Ç—å —Å 25 –º–≥/—Å—É—Ç; —Ü–µ–ª–µ–≤–∞—è 50‚Äì100 –º–≥/—Å—É—Ç",
        "renal": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",
        "hepatic": "‚Üì –¥–æ–∑–∞; –ø—Ä–∏–º–µ–Ω—è—Ç—å —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é",
        "notes": "–ü—Ä–µ–ø–∞—Ä–∞—Ç –≤—ã–±–æ—Ä–∞ –ø—Ä–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –∫–∞—Ä–¥–∏–∞–ª—å–Ω–æ–π –ø–∞—Ç–æ–ª–æ–≥–∏–∏; –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π CYP2D6 —ç—Ñ—Ñ–µ–∫—Ç",
    },
    "–≠—Å—Ü–∏—Ç–∞–ª–æ–ø—Ä–∞–º": {
        "start": "5‚Äì10 –º–≥/—Å—É—Ç",
        "target": "10‚Äì20 –º–≥/—Å—É—Ç",
        "max": "20 –º–≥/—Å—É—Ç (–ø–æ–∂–∏–ª—ã–µ ‚Äî 10 –º–≥/—Å—É—Ç)",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ 2‚Äì4 –Ω–µ–¥",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç (—É—Ç—Ä–æ–º –∏–ª–∏ –≤–µ—á–µ—Ä–æ–º)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 5/10/20 –º–≥; —Ä–∞—Å—Ç–≤–æ—Ä 5 –º–≥/–º–ª",
        "elderly": "–ú–∞–∫—Å–∏–º—É–º 10 –º–≥/—Å—É—Ç (—Ä–∏—Å–∫ QTc —É–¥–ª–∏–Ω–µ–Ω–∏—è)",
        "renal": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏ –°–ö–§ >20 –º–ª/–º–∏–Ω",
        "hepatic": "5‚Äì10 –º–≥/—Å—É—Ç –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "notes": "‚ö†Ô∏è –î–æ–∑–∞-–∑–∞–≤–∏—Å–∏–º–æ–µ —É–¥–ª–∏–Ω–µ–Ω–∏–µ QTc ‚Üí –≠–ö–ì –ø—Ä–∏ ‚Üë–¥–æ–∑–µ; –Ω–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å 20 –º–≥/—Å—É—Ç",
    },
    "–ü–∞—Ä–æ–∫—Å–µ—Ç–∏–Ω": {
        "start": "10‚Äì20 –º–≥/—Å—É—Ç",
        "target": "20‚Äì40 –º–≥/—Å—É—Ç",
        "max": "60 –º–≥/—Å—É—Ç",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –Ω–∞ 10 –º–≥ –∫–∞–∂–¥—ã–µ 1‚Äì2 –Ω–µ–¥",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç (—É—Ç—Ä–æ–º —Å –µ–¥–æ–π)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 10/20/30/40 –º–≥; CR —Ç–∞–±–ª–µ—Ç–∫–∏ 12.5/25/37.5 –º–≥; —Å—É—Å–ø–µ–Ω–∑–∏—è 10 –º–≥/5 –º–ª",
        "elderly": "10‚Äì40 –º–≥/—Å—É—Ç; –∏–∑–±–µ–≥–∞—Ç—å –ø—Ä–∏ –¥–µ–º–µ–Ω—Ü–∏–∏ (–∞–Ω—Ç–∏—Ö–æ–ª–∏–Ω–µ—Ä–≥–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç)",
        "renal": "–°–ö–§ <30 ‚Üí –Ω–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å 20 –º–≥/—Å—É—Ç",
        "hepatic": "–ù–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å 20 –º–≥/—Å—É—Ç –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "notes": "–í—ã—Ä–∞–∂–µ–Ω–Ω—ã–π —Å–∏–Ω–¥—Ä–æ–º –æ—Ç–º–µ–Ω—ã ‚Üí –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –æ—Ç–º–µ–Ω–∞. –ú–æ—â–Ω—ã–π CYP2D6 –∏–Ω–≥–∏–±–∏—Ç–æ—Ä",
    },
    "–í–µ–Ω–ª–∞—Ñ–∞–∫—Å–∏–Ω": {
        "start": "37.5‚Äì75 –º–≥/—Å—É—Ç (ER —Ñ–æ—Ä–º–∞)",
        "target": "150‚Äì225 –º–≥/—Å—É—Ç",
        "max": "375 –º–≥/—Å—É—Ç",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –Ω–∞ 75 –º–≥ –∫–∞–∂–¥—ã–µ 2‚Äì4 –Ω–µ–¥",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç (ER) —Å –µ–¥–æ–π",
        "forms": "–ö–∞–ø—Å—É–ª—ã ER 37.5/75/150 –º–≥; —Ç–∞–±–ª–µ—Ç–∫–∏ IR 25/37.5/50/75/100 –º–≥",
        "elderly": "–ù–∞—á–∏–Ω–∞—Ç—å —Å 37.5 –º–≥/—Å—É—Ç; –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ê–î",
        "renal": "–°–ö–§ 10‚Äì70 ‚Üí ‚Üì –¥–æ–∑—É –Ω–∞ 25‚Äì50%; –¥–∏–∞–ª–∏–∑ ‚Üí ‚Üì –Ω–∞ 50%",
        "hepatic": "–õ—ë–≥–∫–æ–µ/—É–º–µ—Ä–µ–Ω–Ω–æ–µ ‚Üí ‚Üì –Ω–∞ 50%",
        "notes": "‚ö†Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ê–î (‚Üë —Å–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏ >150 –º–≥/—Å—É—Ç). –í—ã—Ä–∞–∂–µ–Ω–Ω—ã–π —Å–∏–Ω–¥—Ä–æ–º –æ—Ç–º–µ–Ω—ã ‚Üí –æ—Ç–º–µ–Ω—è—Ç—å –º–µ–¥–ª–µ–Ω–Ω–æ",
    },
    "–î—É–ª–æ–∫—Å–µ—Ç–∏–Ω": {
        "start": "30‚Äì60 –º–≥/—Å—É—Ç",
        "target": "60‚Äì120 –º–≥/—Å—É—Ç",
        "max": "120 –º–≥/—Å—É—Ç",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Å 30 –º–≥/—Å—É—Ç —á–µ—Ä–µ–∑ 1‚Äì2 –Ω–µ–¥",
        "schedule": "1‚Äì2 —Ä–∞–∑–∞/—Å—É—Ç —Å –µ–¥–æ–π",
        "forms": "–ö–∞–ø—Å—É–ª—ã 20/30/60 –º–≥",
        "elderly": "30 –º–≥/—Å—É—Ç –Ω–∞—á–∞–ª—å–Ω–∞—è; —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é",
        "renal": "–°–ö–§ <30 ‚Äî –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è",
        "hepatic": "–ü—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "notes": "–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–∏ –Ω–µ–π—Ä–æ–ø–∞—Ç–∏—á–µ—Å–∫–æ–π –±–æ–ª–∏ –∏ –ì–¢–† –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –¥–µ–ø—Ä–µ—Å—Å–∏–∏",
    },
    "–ê–º–∏—Ç—Ä–∏–ø—Ç–∏–ª–∏–Ω": {
        "start": "25‚Äì50 –º–≥/—Å—É—Ç",
        "target": "100‚Äì200 –º–≥/—Å—É—Ç (–¥–µ–ø—Ä–µ—Å—Å–∏—è); 10‚Äì50 –º–≥/—Å—É—Ç (–±–æ–ª—å/–º–∏–≥—Ä–µ–Ω—å)",
        "max": "300 –º–≥/—Å—É—Ç",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –Ω–∞ 25‚Äì50 –º–≥ –∫–∞–∂–¥—ã–µ 1‚Äì2 –Ω–µ–¥ –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –≠–ö–ì",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç –≤–µ—á–µ—Ä–æ–º (—Å–µ–¥–∞—Ç–∏–≤–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç); –∏–ª–∏ –≤ 2‚Äì3 –ø—Ä–∏—ë–º–∞",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 10/25/50/75/100/150 –º–≥; —Ä–∞—Å—Ç–≤–æ—Ä –¥–ª—è –∏–Ω—ä–µ–∫—Ü–∏–π 10 –º–≥/–º–ª",
        "elderly": "‚ùå –°–ø–∏—Å–æ–∫ –ë–∏—Ä—Å–∞ ‚Äî –∏–∑–±–µ–≥–∞—Ç—å. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚â§25 –º–≥/—Å—É—Ç –Ω–∞ –Ω–æ—á—å (–±–æ–ª—å)",
        "renal": "–° –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é; –≤–æ–∑–º–æ–∂–Ω–∞ –∫—É–º—É–ª—è—Ü–∏—è",
        "hepatic": "–ò–∑–±–µ–≥–∞—Ç—å –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "notes": "‚ö†Ô∏è –≠–ö–ì –¥–æ –Ω–∞—á–∞–ª–∞ –ª–µ—á–µ–Ω–∏—è –∏ –ø—Ä–∏ ‚Üë–¥–æ–∑–µ. –ö–∞—Ä–¥–∏–æ—Ç–æ–∫—Å–∏—á–µ–Ω –ø—Ä–∏ –ø–µ—Ä–µ–¥–æ–∑–∏—Ä–æ–≤–∫–µ. TDM –ø—Ä–∏ >150 –º–≥/—Å—É—Ç",
    },
    "–ö–ª–æ–º–∏–ø—Ä–∞–º–∏–Ω": {
        "start": "25 –º–≥/—Å—É—Ç",
        "target": "100‚Äì250 –º–≥/—Å—É—Ç",
        "max": "250 –º–≥/—Å—É—Ç (–∞–º–±—É–ª–∞—Ç–æ—Ä–Ω–æ); 300 –º–≥/—Å—É—Ç (—Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä)",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –Ω–∞ 25 –º–≥ –∫–∞–∂–¥—ã–µ 3‚Äì7 –¥–Ω–µ–π",
        "schedule": "–í –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—ë–º–æ–≤ –∏–ª–∏ 1 —Ä–∞–∑/—Å—É—Ç –≤–µ—á–µ—Ä–æ–º",
        "forms": "–ö–∞–ø—Å—É–ª—ã 10/25/50/75 –º–≥; —Ä–∞—Å—Ç–≤–æ—Ä –¥–ª—è –∏–Ω—Ñ—É–∑–∏–π 25 –º–≥/2 –º–ª",
        "elderly": "–ù–∞—á–∏–Ω–∞—Ç—å —Å 10‚Äì25 –º–≥/—Å—É—Ç; –Ω–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å 50‚Äì75 –º–≥/—Å—É—Ç",
        "renal": "–° –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é",
        "hepatic": "–ò–∑–±–µ–≥–∞—Ç—å –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "notes": "–ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –ø—Ä–∏ –û–ö–† —Å—Ä–µ–¥–∏ –¢–¶–ê; TDM –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ –¥–æ–∑–∞—Ö >150 –º–≥/—Å—É—Ç",
    },
    "–ö–ª–æ–∑–∞–ø–∏–Ω": {
        "start": "12.5‚Äì25 –º–≥/—Å—É—Ç",
        "target": "300‚Äì450 –º–≥/—Å—É—Ç (—Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è —à–∏–∑–æ—Ñ—Ä–µ–Ω–∏—è)",
        "max": "900 –º–≥/—Å—É—Ç",
        "titration": "‚Üë –Ω–∞ 25‚Äì50 –º–≥ –∫–∞–∂–¥—ã–µ 1‚Äì2 –¥–Ω—è; –º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏ –∫–∞—Ä–¥–∏–∞–ª—å–Ω—ã—Ö —Ä–∏—Å–∫–∞—Ö",
        "schedule": "2‚Äì3 —Ä–∞–∑–∞/—Å—É—Ç; –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∑–∞ –Ω–∞ –Ω–æ—á—å (—Å–µ–¥–∞—Ü–∏—è)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 25/100/200 –º–≥; —Å—É—Å–ø–µ–Ω–∑–∏—è 50 –º–≥/–º–ª",
        "elderly": "–ù–∞—á–∏–Ω–∞—Ç—å —Å 6.25‚Äì12.5 –º–≥; –∫—Ä–∞–π–Ω–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ",
        "renal": "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ; –¥–∞–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã",
        "hepatic": "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ; –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∞–Ω—Å–∞–º–∏–Ω–∞–∑",
        "notes": "‚ö†Ô∏è –û–±—è–∑–∞—Ç–µ–ª–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ–π—Ç—Ä–æ—Ñ–∏–ª–æ–≤ (ANC): –∏—Å—Ö–æ–¥–Ω–æ, –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ 6 –º–µ—Å, –∑–∞—Ç–µ–º ‚Üì—á–∞—Å—Ç–æ—Ç–∞. TDM: —Ü–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å 250‚Äì350 –Ω–≥/–º–ª",
    },
    "–û–ª–∞–Ω–∑–∞–ø–∏–Ω": {
        "start": "5‚Äì10 –º–≥/—Å—É—Ç",
        "target": "10‚Äì20 –º–≥/—Å—É—Ç",
        "max": "20 –º–≥/—Å—É—Ç (—Ä—É—Ç–∏–Ω–Ω–æ); –¥–æ 30‚Äì40 –ø—Ä–∏ —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –Ω–∞ 5 –º–≥ –∫–∞–∂–¥—ã–µ 1‚Äì2 –Ω–µ–¥",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç (–≤–µ—á–µ—Ä–æ–º, —Ç.–∫. —Å–µ–¥–∞—Ü–∏—è)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 2.5/5/7.5/10/15/20 –º–≥; –û–î–¢; –¥–µ–ø–æ (IM) 150/210/300/405 –º–≥/28 –¥–Ω–µ–π",
        "elderly": "2.5‚Äì5 –º–≥/—Å—É—Ç –Ω–∞—á–∞–ª—å–Ω–∞—è; ‚ö†Ô∏è ‚Üë—Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏ –¥–µ–º–µ–Ω—Ü–∏–∏ (black box)",
        "renal": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",
        "hepatic": "‚Üì –¥–æ–∑–∞ –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "notes": "‚ö†Ô∏è –ú–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω: –≤–µ—Å, –≥–ª—é–∫–æ–∑–∞, –ª–∏–ø–∏–¥—ã –∫–∞–∂–¥—ã–µ 3 –º–µ—Å",
    },
    "–†–∏—Å–ø–µ—Ä–∏–¥–æ–Ω": {
        "start": "0.5‚Äì1 –º–≥/—Å—É—Ç",
        "target": "4‚Äì6 –º–≥/—Å—É—Ç",
        "max": "16 –º–≥/—Å—É—Ç",
        "titration": "‚Üë –Ω–∞ 1‚Äì2 –º–≥ –∫–∞–∂–¥—ã–µ 5‚Äì7 –¥–Ω–µ–π",
        "schedule": "1‚Äì2 —Ä–∞–∑–∞/—Å—É—Ç",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 0.5/1/2/3/4 –º–≥; —Ä–∞—Å—Ç–≤–æ—Ä 1 –º–≥/–º–ª; –û–î–¢; –¥–µ–ø–æ (Risperdal Consta) 12.5‚Äì50 –º–≥/2 –Ω–µ–¥",
        "elderly": "0.25‚Äì0.5 –º–≥ 2 —Ä–∞–∑–∞/—Å—É—Ç; ‚ö†Ô∏è –¥–µ–º–µ–Ω—Ü–∏—è ‚Äî black box",
        "renal": "–°–ö–§ <30 ‚Üí –Ω–∞—á–∏–Ω–∞—Ç—å —Å 0.5 –º–≥ 2 —Ä–∞–∑–∞/—Å—É—Ç",
        "hepatic": "–ù–∞—á–∏–Ω–∞—Ç—å —Å 0.5 –º–≥ 2 —Ä–∞–∑–∞/—Å—É—Ç",
        "notes": "‚ö†Ô∏è –ù–∞–∏–±–æ–ª—å—à–∏–π —Ä–∏—Å–∫ –≥–∏–ø–µ—Ä–ø—Ä–æ–ª–∞–∫—Ç–∏–Ω–µ–º–∏–∏ —Å—Ä–µ–¥–∏ –∞—Ç–∏–ø–∏—á–Ω—ã—Ö. –≠–∫—Å—Ç—Ä–∞–ø–∏—Ä–∞–º–∏–¥–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –ø—Ä–∏ >6 –º–≥/—Å—É—Ç",
    },
    "–ê—Ä–∏–ø–∏–ø—Ä–∞–∑–æ–ª": {
        "start": "2‚Äì10 –º–≥/—Å—É—Ç",
        "target": "10‚Äì15 –º–≥/—Å—É—Ç",
        "max": "30 –º–≥/—Å—É—Ç",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –∫–∞–∂–¥—ã–µ 2 –Ω–µ–¥",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 2/5/10/15/20/30 –º–≥; —Ä–∞—Å—Ç–≤–æ—Ä 1 –º–≥/–º–ª; –¥–µ–ø–æ (Abilify Maintena) 300‚Äì400 –º–≥/–º–µ—Å",
        "elderly": "–ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–µ–Ω –º–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏; –Ω–∞—á–∏–Ω–∞—Ç—å —Å 2‚Äì5 –º–≥/—Å—É—Ç",
        "renal": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",
        "hepatic": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",
        "notes": "–ü–∞—Ä—Ü–∏–∞–ª—å–Ω—ã–π –∞–≥–æ–Ω–∏—Å—Ç D2/D3 –∏ 5-HT1A. ‚ö†Ô∏è –ê–∫–∞—Ç–∏–∑–∏—è ‚Äî —Ç–∏–ø–∏—á–Ω—ã–π –ø–æ–±–æ—á–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç. –ú–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏ –Ω–µ–π—Ç—Ä–∞–ª–µ–Ω",
    },
    "–õ–∏—Ç–∏–π": {
        "start": "300 –º–≥ 2‚Äì3 —Ä–∞–∑–∞/—Å—É—Ç",
        "target": "–£—Ä–æ–≤–µ–Ω—å Li –≤ –∫—Ä–æ–≤–∏ 0.6‚Äì1.0 –º—ç–∫–≤/–ª (–æ—Å—Ç—Ä–∞—è –º–∞–Ω–∏—è ‚Äî –¥–æ 1.2)",
        "max": "–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ —É—Ä–æ–≤–Ω—é –ª–∏—Ç–∏—è –≤ –∫—Ä–æ–≤–∏",
        "titration": "–£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –ø–æ 300 –º–≥ –∫–∞–∂–¥—ã–µ 5‚Äì7 –¥–Ω–µ–π, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—è —É—Ä–æ–≤–µ–Ω—å –≤ –∫—Ä–æ–≤–∏",
        "schedule": "2‚Äì3 —Ä–∞–∑–∞/—Å—É—Ç (IR); 1 —Ä–∞–∑/—Å—É—Ç –≤–µ—á–µ—Ä–æ–º (ER —Ñ–æ—Ä–º–∞)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 150/300/600 –º–≥; –∫–∞—Ä–±–æ–Ω–∞—Ç –ª–∏—Ç–∏—è ER 300/450 –º–≥; —Ü–∏—Ç—Ä–∞—Ç –ª–∏—Ç–∏—è —Å–∏—Ä–æ–ø",
        "elderly": "–¶–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å 0.4‚Äì0.8 –º—ç–∫–≤/–ª; —Ä–∏—Å–∫ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏ ‚Üë",
        "renal": "–°–ö–§ <30 ‚Äî –∏–∑–±–µ–≥–∞—Ç—å –∏–ª–∏ –∫—Ä–∞–π–Ω–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ. –°–ö–§ 30‚Äì60 ‚Üí ‚Üì –¥–æ–∑—É –Ω–∞ 50%",
        "hepatic": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–Ω–µ –º–µ—Ç–∞–±–æ–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø–µ—á–µ–Ω—å—é)",
        "notes": "‚ö†Ô∏è TDM –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω: –∫—Ä–æ–≤—å —á–µ—Ä–µ–∑ 12 —á –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–æ–∑—ã. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –¢–¢–ì, –¢–¢–ì, –ê–ú–ö/–ö—Ä ‚Äî –∫–∞–∂–¥—ã–µ 6 –º–µ—Å",
    },
    "–í–∞–ª—å–ø—Ä–æ–∞—Ç": {
        "start": "250‚Äì500 –º–≥/—Å—É—Ç",
        "target": "750‚Äì2000 –º–≥/—Å—É—Ç; —É—Ä–æ–≤–µ–Ω—å –≤ –∫—Ä–æ–≤–∏ 50‚Äì100 –º–∫–≥/–º–ª (–æ—Å—Ç—Ä–∞—è –º–∞–Ω–∏—è: 94‚Äì125)",
        "max": "60 –º–≥/–∫–≥/—Å—É—Ç",
        "titration": "‚Üë –Ω–∞ 250‚Äì500 –º–≥ –∫–∞–∂–¥—ã–µ 1‚Äì3 –¥–Ω—è (–æ—Å—Ç—Ä–∞—è –º–∞–Ω–∏—è ‚Äî –±—ã—Å—Ç—Ä–µ–µ)",
        "schedule": "2‚Äì3 —Ä–∞–∑–∞/—Å—É—Ç (IR); 1‚Äì2 —Ä–∞–∑–∞/—Å—É—Ç (ER)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ –≤–∞–ª—å–ø—Ä–æ–µ–≤–æ–π –∫–∏—Å–ª–æ—Ç—ã; –Ω–∞—Ç—Ä–∏—è –≤–∞–ª—å–ø—Ä–æ–∞—Ç; ER —Ç–∞–±–ª–µ—Ç–∫–∏; —Å–∏—Ä–æ–ø; –≤/–≤",
        "elderly": "‚Üì –¥–æ–∑–∞; ‚Üë —É—Ä–æ–≤–µ–Ω—å —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤–∞–ª—å–ø—Ä–æ–∞—Ç–∞ (‚Üì –∞–ª—å–±—É–º–∏–Ω)",
        "renal": "–° –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é; ‚Üë —É—Ä–æ–≤–µ–Ω—å —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞",
        "hepatic": "‚ùå –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏; –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ê–õ–¢/–ê–°–¢",
        "notes": "‚ö†Ô∏è –¢–µ—Ä–∞—Ç–æ–≥–µ–Ω –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ X ‚Äî –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω –ø—Ä–∏ –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏. TDM. –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—á–µ–Ω–∏ –∏ –ø–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç–∞",
    },
    "–õ–∞–º–æ—Ç—Ä–∏–¥–∂–∏–Ω": {
        "start": "25 –º–≥/—Å—É—Ç (–º–æ–Ω–æ—Ç–µ—Ä–∞–ø–∏—è); 12.5 –º–≥/—Å—É—Ç (—Å –≤–∞–ª—å–ø—Ä–æ–∞—Ç–æ–º)",
        "target": "100‚Äì200 –º–≥/—Å—É—Ç (–º–æ–Ω–æ—Ç–µ—Ä–∞–ø–∏—è); 50‚Äì100 –º–≥/—Å—É—Ç (—Å –≤–∞–ª—å–ø—Ä–æ–∞—Ç–æ–º)",
        "max": "400 –º–≥/—Å—É—Ç (–º–æ–Ω–æ—Ç–µ—Ä–∞–ø–∏—è); 200 –º–≥/—Å—É—Ç (—Å –≤–∞–ª—å–ø—Ä–æ–∞—Ç–æ–º)",
        "titration": "–ú–ï–î–õ–ï–ù–ù–ê–Ø: ‚Üë –Ω–∞ 25 –º–≥ –∫–∞–∂–¥—ã–µ 2 –Ω–µ–¥ –ø—Ä–∏ –º–æ–Ω–æ—Ç–µ—Ä–∞–ø–∏–∏; –≤–¥–≤–æ–µ –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Å –≤–∞–ª—å–ø—Ä–æ–∞—Ç–æ–º",
        "schedule": "1‚Äì2 —Ä–∞–∑–∞/—Å—É—Ç",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 25/50/100/150/200 –º–≥; –û–î–¢; –∂–µ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–µ—Ç–∫–∏",
        "elderly": "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–æ–∑—ã —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º",
        "renal": "‚Üì –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º —Å–Ω–∏–∂–µ–Ω–∏–∏ –°–ö–§; –¥–∏–∞–ª–∏–∑ ‚Üí –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∑–∞ –ø–æ—Å–ª–µ —Å–µ–∞–Ω—Å–∞",
        "hepatic": "‚Üì –Ω–∞ 25‚Äì75% –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "notes": "‚ö†Ô∏è –°–∏–Ω–¥—Ä–æ–º –°—Ç–∏–≤–µ–Ω—Å–∞‚Äì–î–∂–æ–Ω—Å–æ–Ω–∞ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º ‚Üë –¥–æ–∑—ã. –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ç–∏—Ç—Ä–∞—Ü–∏—è ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—Ç—å –æ —Å—ã–ø–∏",
    },
    "–î–∏–∞–∑–µ–ø–∞–º": {
        "start": "2‚Äì5 –º–≥/—Å—É—Ç",
        "target": "5‚Äì30 –º–≥/—Å—É—Ç",
        "max": "40 –º–≥/—Å—É—Ç (–∞–º–±—É–ª–∞—Ç–æ—Ä–Ω–æ)",
        "titration": "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∑–∞; –∫—É—Ä—Å ‚â§2‚Äì4 –Ω–µ–¥",
        "schedule": "2‚Äì4 —Ä–∞–∑–∞/—Å—É—Ç –∏–ª–∏ –Ω–∞ –Ω–æ—á—å (–±–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 2/5/10 –º–≥; —Ä–∞—Å—Ç–≤–æ—Ä IM/IV 5 –º–≥/–º–ª; —Ä–µ–∫—Ç–∞–ª—å–Ω—ã–µ —Å–≤–µ—á–∏",
        "elderly": "‚ùå –°–ø–∏—Å–æ–∫ –ë–∏—Ä—Å–∞. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî ‚â§2 –º–≥/–ø—Ä–∏—ë–º; —Ä–∏—Å–∫ –ø–∞–¥–µ–Ω–∏–π",
        "renal": "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "hepatic": "–û—Å—Ç–æ—Ä–æ–∂–Ω–æ ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω—ã–π T¬Ω –Ω–∞—Ä–∞—Å—Ç–∞–µ—Ç",
        "notes": "–ö—É—Ä—Å —Å—Ç—Ä–æ–≥–æ ‚â§4 –Ω–µ–¥. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–æ. –û—Ç–º–µ–Ω–∞ ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ",
    },
    "–ê–ª–ø—Ä–∞–∑–æ–ª–∞–º": {
        "start": "0.25‚Äì0.5 –º–≥ 3 —Ä–∞–∑–∞/—Å—É—Ç",
        "target": "0.5‚Äì4 –º–≥/—Å—É—Ç",
        "max": "4 –º–≥/—Å—É—Ç (—Ç—Ä–µ–≤–æ–≥–∞); 10 –º–≥/—Å—É—Ç (–ø–∞–Ω–∏–∫–∞)",
        "titration": "‚Üë –ø–æ 0.25‚Äì0.5 –º–≥ –∫–∞–∂–¥—ã–µ 3 –¥–Ω—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏",
        "schedule": "3 —Ä–∞–∑–∞/—Å—É—Ç –∏–ª–∏ XR 1 —Ä–∞–∑/—Å—É—Ç",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 0.25/0.5/1/2 –º–≥; XR 0.5/1/2/3 –º–≥",
        "elderly": "‚ùå –°–ø–∏—Å–æ–∫ –ë–∏—Ä—Å–∞. –ö—Ä–∞–π–Ω–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ",
        "renal": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",
        "hepatic": "‚Üì –¥–æ–∑–∞ –ø—Ä–∏ —Ç—è–∂—ë–ª–æ–º –Ω–∞—Ä—É—à–µ–Ω–∏–∏",
        "notes": "–ö–æ—Ä–æ—Ç–∫–∏–π T¬Ω ‚Üí –±–æ–ª–µ–µ –≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–π —Å–∏–Ω–¥—Ä–æ–º –æ—Ç–º–µ–Ω—ã, —á–µ–º —É –¥–∏–∞–∑–µ–ø–∞–º–∞. –ö—É—Ä—Å ‚â§4 –Ω–µ–¥",
    },
    "–ó–æ–ø–∏–∫–ª–æ–Ω": {
        "start": "3.75 –º–≥ (–ø–æ–∂–∏–ª—ã–µ); 7.5 –º–≥ (–≤–∑—Ä–æ—Å–ª—ã–µ)",
        "target": "3.75‚Äì7.5 –º–≥/—Å—É—Ç",
        "max": "7.5 –º–≥/—Å—É—Ç",
        "titration": "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∑–∞; —Ç–æ–ª—å–∫–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ",
        "schedule": "1 —Ä–∞–∑/—Å—É—Ç –ø–µ—Ä–µ–¥ —Å–Ω–æ–º",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 3.75/7.5 –º–≥",
        "elderly": "3.75 –º–≥/—Å—É—Ç; ‚ö†Ô∏è —Ä–∏—Å–∫ –ø–∞–¥–µ–Ω–∏–π",
        "renal": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",
        "hepatic": "‚Üì –¥–æ 3.75 –º–≥/—Å—É—Ç",
        "notes": "–ö—É—Ä—Å ‚â§4 –Ω–µ–¥. Z-–ø—Ä–µ–ø–∞—Ä–∞—Ç (–Ω–µ –±–µ–Ω–∑–æ–¥–∏–∞–∑–µ–ø–∏–Ω, –Ω–æ —Å—Ö–æ–∂–∏–π –ø—Ä–æ—Ñ–∏–ª—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)",
    },
    "–ö–≤–µ—Ç–∏–∞–ø–∏–Ω": {
        "start": "25‚Äì50 –º–≥/—Å—É—Ç",
        "target": "150‚Äì750 –º–≥/—Å—É—Ç (–ø—Å–∏—Ö–æ–∑); 50‚Äì300 –º–≥/—Å—É—Ç (–¥–µ–ø—Ä–µ—Å—Å–∏—è/–ë–ê–†)",
        "max": "800 –º–≥/—Å—É—Ç",
        "titration": "‚Üë –Ω–∞ 25‚Äì50 –º–≥ 2 —Ä–∞–∑–∞/—Å—É—Ç –∫–∞–∂–¥—ã–µ 2 –¥–Ω—è",
        "schedule": "2‚Äì3 —Ä–∞–∑–∞/—Å—É—Ç (IR); 1 —Ä–∞–∑/—Å—É—Ç –≤–µ—á–µ—Ä–æ–º (XR)",
        "forms": "–¢–∞–±–ª–µ—Ç–∫–∏ 25/50/100/150/200/300/400 –º–≥; XR 50/150/200/300/400 –º–≥",
        "elderly": "–ù–∞—á–∏–Ω–∞—Ç—å —Å 25 –º–≥; ‚ö†Ô∏è –¥–µ–º–µ–Ω—Ü–∏—è ‚Äî black box",
        "renal": "–ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",
        "hepatic": "‚Üì –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–æ–∑–∞",
        "notes": "–î–æ–∑–∞ 25‚Äì100 –º–≥ ‚Äî —Å–µ–¥–∞—Ç–∏–≤–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (–Ω–µ—Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ, off-label). –ú–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥",
    },
}

_DOSE_GENERAL_NOTES = {
    "SSRI": "–û–±—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è SSRI: –Ω–∞—á–∏–Ω–∞—Ç—å —Å –Ω–∏–∑–∫–æ–π –¥–æ–∑—ã, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ç—Ä–µ–≤–æ–≥–µ; –ø–µ—Ä–≤—ã–µ 1‚Äì2 –Ω–µ–¥ ‚Äî –Ω–∞—Ä–∞—Å—Ç–∞–Ω–∏–µ —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ; —ç—Ñ—Ñ–µ–∫—Ç –∞–Ω—Ç–∏–¥–µ–ø—Ä–µ—Å—Å–∞–Ω—Ç–∞ ‚Äî —á–µ—Ä–µ–∑ 4‚Äì8 –Ω–µ–¥.",
    "SNRI": "–î–æ–∑–∞-–∑–∞–≤–∏—Å–∏–º—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã: –ø—Ä–∏ –Ω–∏–∑–∫–∏—Ö –¥–æ–∑–∞—Ö ‚Äî –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —Å–µ—Ä–æ—Ç–æ–Ω–∏–Ω–µ—Ä–≥–∏—á–µ—Å–∫–∏–π, –ø—Ä–∏ –≤—ã—Å–æ–∫–∏—Ö ‚Äî –Ω–æ—Ä–∞–¥—Ä–µ–Ω–µ—Ä–≥–∏—á–µ—Å–∫–∏–π. –ê–î –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å.",
    "TCA": "–ü–µ—Ä–µ–¥ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º ‚Äî –≠–ö–ì. TDM –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ –¥–æ–∑–∞—Ö >150 –º–≥/—Å—É—Ç. –ö–∞—Ä–¥–∏–æ—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ–¥–æ–∑–∏—Ä–æ–≤–∫–µ ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ —Å–º–µ—Ä—Ç–∏.",
    "MAOI": "–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ —Ç–∏—Ä–∞–º–∏–Ω–æ–≤–∞—è –¥–∏–µ—Ç–∞. –û—Ç–º—ã–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ MAOI: 2 –Ω–µ–¥ (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∞–Ω—Ç–∏–¥–µ–ø—Ä–µ—Å—Å–∞–Ω—Ç–æ–≤); 5 –Ω–µ–¥ (—Ñ–ª—É–æ–∫—Å–µ—Ç–∏–Ω); 2 –Ω–µ–¥ –ø–µ—Ä–µ–¥ –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –∞–Ω—Ç–∏–¥–µ–ø—Ä–µ—Å—Å–∞–Ω—Ç–æ–º.",
    "–ê—Ç–∏–ø–∏—á–Ω—ã–µ –∞–Ω—Ç–∏–ø—Å–∏—Ö–æ—Ç–∏–∫–∏": "–ú–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –≤–µ—Å, –û–¢, –ê–î, –≥–ª—é–∫–æ–∑–∞, –ª–∏–ø–∏–¥—ã ‚Äî –∏—Å—Ö–æ–¥–Ω–æ, —á–µ—Ä–µ–∑ 3 –º–µ—Å, –∑–∞—Ç–µ–º –µ–∂–µ–≥–æ–¥–Ω–æ.",
    "–¢–∏–ø–∏—á–Ω—ã–µ –∞–Ω—Ç–∏–ø—Å–∏—Ö–æ—Ç–∏–∫–∏": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≠–ü–°. –ü—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ ‚Äî —Ä–∏—Å–∫ —Ç–∞—Ä–¥–∏–≤–Ω–æ–π –¥–∏—Å–∫–∏–Ω–µ–∑–∏–∏.",
    "–°—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è": "TDM: –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è –ª–∏—Ç–∏—è –∏ –≤–∞–ª—å–ø—Ä–æ–∞—Ç–∞. –õ–∞–º–æ—Ç—Ä–∏–¥–∂–∏–Ω ‚Äî –º–µ–¥–ª–µ–Ω–Ω–∞—è —Ç–∏—Ç—Ä–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞.",
    "–ë–µ–Ω–∑–æ–¥–∏–∞–∑–µ–ø–∏–Ω—ã": "–ö—É—Ä—Å ‚â§4 –Ω–µ–¥ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –æ—Ç–º–µ–Ω–∞. –°–ø–∏—Å–æ–∫ –ë–∏—Ä—Å–∞: –∏–∑–±–µ–≥–∞—Ç—å —É –ø–æ–∂–∏–ª—ã—Ö.",
    "Z-–ø—Ä–µ–ø–∞—Ä–∞—Ç—ã": "–¢–æ–ª—å–∫–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ. –°—Ö–æ–∂–∏–π —Ä–∏—Å–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –±–µ–Ω–∑–æ–¥–∏–∞–∑–µ–ø–∏–Ω–∞–º–∏.",
    "–°—Ç–∏–º—É–ª—è—Ç–æ—Ä—ã": "–ö–æ–Ω—Ç—Ä–æ–ª—å –ê–î –∏ –ß–°–°. –û—Ü–µ–Ω–∫–∞ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –≤ –∞–Ω–∞–º–Ω–µ–∑–µ.",
}


def _lookup_drug(name: str) -> tuple[dict | None, dict | None]:
    """Returns (drug_db_record, dose_table_record)."""
    drug = get_drug_by_name(name)
    if not drug:
        results = search_drugs(name)
        drug = results[0] if results else None
    if not drug:
        return None, None
    # Try dose table lookup by name
    dose_info = None
    for key in _DOSE_TABLE:
        if key.lower() == drug["name"].lower():
            dose_info = _DOSE_TABLE[key]
            break
    return drug, dose_info


def _build_dose_text(drug: dict, dose_info: dict | None) -> str:
    lines = [
        f"üíâ *–î–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ: {drug['name']}*",
        f"–ö–ª–∞—Å—Å: {drug.get('class', '‚Äî')}",
        "",
    ]

    if dose_info:
        lines += [
            f"‚ñ∂Ô∏è *–ù–∞—á–∞–ª—å–Ω–∞—è –¥–æ–∑–∞:* {dose_info['start']}",
            f"üéØ *–¢–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω:* {dose_info['target']}",
            f"üîù *–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–∑–∞:* {dose_info['max']}",
            f"üìà *–¢–∏—Ç—Ä–∞—Ü–∏—è:* {dose_info['titration']}",
            f"üïê *–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏—ë–º–∞:* {dose_info['schedule']}",
            f"üíä *–§–æ—Ä–º—ã –≤—ã–ø—É—Å–∫–∞:* {dose_info['forms']}",
            "",
            "üë¥ *–ü–æ–∂–∏–ª—ã–µ:*",
            dose_info["elderly"],
            "",
            "ü´Ä *–ü–æ—á–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å:*",
            dose_info["renal"],
            "",
            "ü´Å *–ü–µ—á—ë–Ω–æ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å:*",
            dose_info["hepatic"],
            "",
            "üìå *–í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è:*",
            dose_info["notes"],
        ]
    else:
        # Fallback to general drug info
        lines += [
            f"‚ñ∂Ô∏è *–î–æ–∑–∏—Ä–æ–≤–∫–∞ (–∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞):*",
            drug.get("dosage") or "–£—Ç–æ—á–Ω–∏—Ç—å –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
            "",
        ]
        drug_class = drug.get("class", "")
        general = _DOSE_GENERAL_NOTES.get(drug_class)
        if general:
            lines += ["üìå *–û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –¥–ª—è –∫–ª–∞—Å—Å–∞:*", general]

    # General class notes
    drug_class = drug.get("class", "")
    general = _DOSE_GENERAL_NOTES.get(drug_class)
    if dose_info and general:
        lines += ["", "‚ÑπÔ∏è *–ü—Ä–∏–Ω—Ü–∏–ø—ã –¥–ª—è –∫–ª–∞—Å—Å–∞:*", general]

    lines += [
        "",
        "‚ö†Ô∏è _–î–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ. "
        "–°–≤–µ—Ä—è–π—Ç–µ—Å—å —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –∏ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏._",
    ]
    return "\n".join(lines)


# ‚îÄ‚îÄ‚îÄ Conversation ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

async def start_dose_calc(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    await update.message.reply_text(
        "üíâ *–î–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤*\n\n"
        "–í–≤–µ–¥–∏—Ç–µ –ú–ù–ù –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞:\n"
        "_–ù–∞–ø—Ä–∏–º–µ—Ä: –§–ª—É–æ–∫—Å–µ—Ç–∏–Ω, –ö–ª–æ–∑–∞–ø–∏–Ω, –õ–∏—Ç–∏–π, –õ–∞–º–æ—Ç—Ä–∏–¥–∂–∏–Ω_",
        parse_mode="Markdown",
        reply_markup=back_keyboard("back:main"),
    )
    return DOSE_CALC_DRUG


async def dose_calc_drug_message(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    name = update.message.text.strip()
    drug, dose_info = _lookup_drug(name)

    if not drug:
        await update.message.reply_text(
            f"‚ö†Ô∏è –ü—Ä–µ–ø–∞—Ä–∞—Ç *{name}* –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ.\n\n"
            "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –ú–ù–ù (–Ω–∞ —Ä—É—Å—Å–∫–æ–º) –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.",
            parse_mode="Markdown",
        )
        return DOSE_CALC_DRUG

    text = _build_dose_text(drug, dose_info)
    for i in range(0, len(text), 4000):
        await update.message.reply_text(text[i:i + 4000], parse_mode="Markdown")

    await update.message.reply_text(
        "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–∏.",
        reply_markup=dose_calc_result_keyboard(),
    )
    return DOSE_CALC_RESULT


async def dose_calc_result_callback(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    data = query.data

    if data == "back:main":
        await query.message.reply_text("–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:", reply_markup=main_menu_keyboard())
        await query.message.delete()
        return MAIN_MENU

    if data == "dc:again":
        await query.message.reply_text(
            "–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞:",
            reply_markup=back_keyboard("back:main"),
        )
        return DOSE_CALC_DRUG

    return DOSE_CALC_RESULT
